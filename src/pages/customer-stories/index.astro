---
import Layout from "@/layouts/Layout.astro";
import CommonHerosection from "@/components/herosection/CommonHeroSection.vue";
import CaseStudiesCategory from "@/components/case-studies/CaseStudiesCategory.vue";
import CustomSection from "@/components/core/CustomSection.vue";
import CaseStudiesListingWrapper from "@/components/case-studies/CaseStudiesListingWrapper.vue";
import {
  getAllCaseStudies,
  getCaseStudiesByPagination,
} from "@/utils/api/blog";
import { ITEMS_PER_PAGE } from "@/utils/api/constant";
import { getTotalCounts } from "@/utils/cache";
// Get the current page from URL parameters
const { page } = Astro.params;
const currentPage = page ? parseInt(page) : 1;

// Fetch blogs data with the current page
const caseStudiesData = await getCaseStudiesByPagination(
  currentPage,
  ITEMS_PER_PAGE
);
const allCaseStudiesData = await getAllCaseStudies();
const count = await getTotalCounts();

const meta = {
  title: "Case Studies | OpenObserve",
  description:
    "Discover how OpenObserve enhances observability across industries. Case studies showcase cost-effective, scalable solutions for logs, metrics, and traces in real-world applications.",
};
---

<Layout metaObj={meta}>
  <CommonHerosection title="Customer Stories" align="CENTER" client:load />
  <CustomSection sectionClass=" !py-8 md:!py-10 lg:!py-16">
    <CaseStudiesListingWrapper
      allCaseStudies={allCaseStudiesData}
      caseStudies={caseStudiesData}
      searchBar
      type="case-studies"
      totalItems={count.caseStudiesCount}
      currentPage={currentPage}
      client:load="vue"
    />
  </CustomSection>
</Layout>
