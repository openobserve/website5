---
import Layout from "@/layouts/Layout.astro";
import CommonHerosection from "@/components/herosection/CommonHeroSection.vue";
import CaseStudiesCategory from "@/components/case-studies/CaseStudiesCategory.vue";
import CustomSection from "@/components/core/CustomSection.vue";
import CaseStudiesListingWrapper from "@/components/case-studies/CaseStudiesListingWrapper.vue";
import {
  getAllCaseStudies,
  getCaseStudiesByPagination,
} from "@/utils/api/blog";
import { ITEMS_PER_PAGE } from "@/utils/api/constant";
import { getTotalCounts } from "@/utils/cache";
// Get the current page from URL parameters
const { page } = Astro.params;
const currentPage = page ? parseInt(page) : 1;

// Fetch blogs data with the current page
const caseStudiesData = await getCaseStudiesByPagination(
  currentPage,
  ITEMS_PER_PAGE
);
const allCaseStudiesData = await getAllCaseStudies();
const count = await getTotalCounts();

const tags = [
  {
    name: "E-commerce",
    slug: "ecommerce",
  },
  {
    name: "SaaS",
    slug: "saas",
  },
  {
    name: "Financial Services",
    slug: "financial-services",
  },
  {
    name: "Healthcare",
    slug: "healthcare",
  },
  {
    name: "Gaming",
    slug: "gaming",
  },
  {
    name: "Cloud Services",
    slug: "cloud-services",
  },
];

const meta = {
  title: "Case Studies | OpenObserve",
  description:
    "Discover how OpenObserve enhances observability across industries. Case studies showcase cost-effective, scalable solutions for logs, metrics, and traces in real-world applications.",
};
---

<Layout metaObj={meta}>
  <CommonHerosection title="Customer Stories" align="center" client:load />
  <CustomSection sectionClass="">
    <CaseStudiesCategory tags={tags} client:load />
    <CaseStudiesListingWrapper
      allCaseStudies={allCaseStudiesData}
      caseStudies={caseStudiesData}
      searchBar
      type="case-studies"
      totalItems={count.caseStudiesCount}
      currentPage={currentPage}
      client:only="vue"
    />
  </CustomSection>
</Layout>
